<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
<title>Бронь-онлайн - Квартиры посуточно Хабаровск</title>


<meta name="keywords" content="Бронь-онлайн" />
<meta name="description" content="" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0">

<base href=""/>
<link rel="shortcut icon" href="assets/site/image/favicon.ico">
<link rel="stylesheet" href="assets/site/css/reset.min.css">
<link rel="stylesheet" href="assets/site/css/index.css">

<link rel="stylesheet" href="assets/site/css/table.css">

<link rel='stylesheet' href='assets/site/css/swiper.min.css'>
<link rel="stylesheet" href="assets/site/css/style.css">
<link rel="stylesheet" type="text/css" media="all" href="assets/site/css/daterangepicker.css" />
<link rel="stylesheet" type="text/css" media="all" href="assets/site/css/jquery-clockpicker.min.css" />

<script type="text/javascript" src="assets/js/jquery.min.js"></script>

<script type="text/javascript" src="assets/site/js/moment.min.js"></script>
<script type="text/javascript" src="assets/site/js/moment.ru.js"></script>
<script type="text/javascript" src="assets/site/js/daterangepicker.js"></script>
<script type="text/javascript" src="assets/site/js/jquery-clockpicker.min.js"></script>
		<script>
			$(function() {
				var menu = $('.out');
				$('#pull').on('click', function(e) {
					e.preventDefault();
					menu.slideToggle()
					$('.menu').toggleClass('active');
				});
				$(window).resize(function(){
					var w = $(window).width();
					if(w > 320 && menu.is(':hidden')) {
						menu.removeAttr('style');
					}
				});
			});
		</script>
	</head>
	
	<body>
		<nav class="nav clearfix">
			<ul class="out clearfix"><li class="row first"><span class="mas">Главная</span><a href="index.html" title="Главная" >Главная</a></li>
<li class="row"><span class="mas">Квартиры</span><a href="kvartiry.html" title="Квартиры" >Квартиры</a></li>
<li class="row active"><span class="mas">Бронь-онлайн</span><a href="bron-onlajn.html" title="Бронь-онлайн" >Бронь-онлайн</a></li>
<li class="row"><span class="mas">Доп. услуги</span><a href="" title="Доп. услуги" >Доп. услуги</a></li>
<li class="row last"><span class="mas">Корпоративным клиентам</span><a href="" title="Корпоративным клиентам" >Корпоративным клиентам</a></li>
</ul>
			<a href="#" id="pull" class="mod">
				<div class="menu">
					<div class="bar"></div>
					<div class="bar"></div>
					<div class="bar"></div>
				</div>				
			</a>
		</nav>
		<div class="logo"><img src="assets/site/image/logo.jpg" alt="Квартиры посуточно Хабаровск"><h1>Квартиры посуточно Хабаровск</h1></div>
		<div id="butts">
			<a href="tel://+79098570114" title="Телефон" class="telbutt blue"><img src="assets/site/image/phone.png" alt="Телефон"><span>+7-909-857-01-14</span></a>
			<a href="whatsapp://send?phone=79098570114" title="Whatsapp"  class="telbutt grin"><img src="assets/site/image/whatsapp.png" alt="whatsapp"><span>Whatsapp</span></a>			
		</div>
<div class="tabs">
	<div class="tab-2">
		<label for="tab2-1">Бронирование</label>
		<input id="tab2-1" name="tabs-two" type="radio" checked="checked">
		<div>
			<div class="cont-label">Выберите даты</div>
			<div id="contpicker">
				<input type="hidden" id="dataBook">
				<div id="findData"></div>
			</div>

			<div class="cont-label">Доступные квартиры</div>
			<div class="table inactive">
				<div class="header"><div class="part">Адрес</div><div class="part">Аренда</div><div class="part">Цена за сутки</div></div>
				<div class="body">
					
					<div id="1551207193361" class="cell" >
	<div class="cell-header">
		<div class="header-before" style="background-image: url(assets/cache/images/per_krac_d24/img_5977-16-02-19-10-28-400x272-6fe.jpg)"></div>
		<div class="addres cell-subtitle">пер.Краснореченский д.24-2</div>
	</div>
	<div class="cell-body">
		<div class="cell-list">
			<div class="data cell-list-item">Свободна</div>
			<div class="place cell-list-item">Спальных мест <span> 4</span></div>
		</div>
	</div>
	<div class="cell-footer">
		<div class="prace cell-price">&#8381; <span> 2000</span></div>
		<button class="cell-button">
			<label for="aport">Выбрать</label>
		</button>
		<input class="aport" id="aport_1" type="radio" name="aport" value=1551207193361>
	</div>
</div><div id="1551207193372" class="cell" >
	<div class="cell-header">
		<div class="header-before" style="background-image: url(assets/cache/images/per_krac_d24/img_5976-16-02-19-10-28-400x272-c44.jpg)"></div>
		<div class="addres cell-subtitle">пер.Краснореченский д.24-3</div>
	</div>
	<div class="cell-body">
		<div class="cell-list">
			<div class="data cell-list-item">Свободна</div>
			<div class="place cell-list-item">Спальных мест <span> 4</span></div>
		</div>
	</div>
	<div class="cell-footer">
		<div class="prace cell-price">&#8381; <span> 2000</span></div>
		<button class="cell-button">
			<label for="aport">Выбрать</label>
		</button>
		<input class="aport" id="aport_2" type="radio" name="aport" value=1551207193372>
	</div>
</div><div id="1551207193380" class="cell" >
	<div class="cell-header">
		<div class="header-before" style="background-image: url(assets/cache/images/per_krac_d24/img_5978-16-02-19-10-28-400x272-086.jpg)"></div>
		<div class="addres cell-subtitle">пер.Краснореченский д.24-7</div>
	</div>
	<div class="cell-body">
		<div class="cell-list">
			<div class="data cell-list-item">Свободна</div>
			<div class="place cell-list-item">Спальных мест <span> 4</span></div>
		</div>
	</div>
	<div class="cell-footer">
		<div class="prace cell-price">&#8381; <span> 2000</span></div>
		<button class="cell-button">
			<label for="aport">Выбрать</label>
		</button>
		<input class="aport" id="aport_3" type="radio" name="aport" value=1551207193380>
	</div>
</div><div id="1551207193385" class="cell" >
	<div class="cell-header">
		<div class="header-before" style="background-image: url(assets/cache/images/per_krac_d22/img_6007-16-02-19-10-30-400x272-cee.jpg)"></div>
		<div class="addres cell-subtitle">пер.Краснореченский д.22-1</div>
	</div>
	<div class="cell-body">
		<div class="cell-list">
			<div class="data cell-list-item">Свободна</div>
			<div class="place cell-list-item">Спальных мест <span> 2</span></div>
		</div>
	</div>
	<div class="cell-footer">
		<div class="prace cell-price">&#8381; <span> 1400</span></div>
		<button class="cell-button">
			<label for="aport">Выбрать</label>
		</button>
		<input class="aport" id="aport_4" type="radio" name="aport" value=1551207193385>
	</div>
</div><div id="1551207193395" class="cell" >
	<div class="cell-header">
		<div class="header-before" style="background-image: url(assets/cache/images/per_krac_d22/img_6008-16-02-19-10-30-400x272-34d.jpg)"></div>
		<div class="addres cell-subtitle">пер.Краснореченский д.22-3</div>
	</div>
	<div class="cell-body">
		<div class="cell-list">
			<div class="data cell-list-item">Свободна</div>
			<div class="place cell-list-item">Спальных мест <span> 2</span></div>
		</div>
	</div>
	<div class="cell-footer">
		<div class="prace cell-price">&#8381; <span> 1400</span></div>
		<button class="cell-button">
			<label for="aport">Выбрать</label>
		</button>
		<input class="aport" id="aport_5" type="radio" name="aport" value=1551207193395>
	</div>
</div><div id="1551207200596" class="cell" >
	<div class="cell-header">
		<div class="header-before" style="background-image: url(assets/cache/images/per_krac_d26/img_6318-06-03-19-05-44-400x272-ae6.jpg)"></div>
		<div class="addres cell-subtitle">пер.Краснореченский д.26</div>
	</div>
	<div class="cell-body">
		<div class="cell-list">
			<div class="data cell-list-item">Свободна</div>
			<div class="place cell-list-item">Спальных мест <span> 4</span></div>
		</div>
	</div>
	<div class="cell-footer">
		<div class="prace cell-price">&#8381; <span> 1800</span></div>
		<button class="cell-button">
			<label for="aport">Выбрать</label>
		</button>
		<input class="aport" id="aport_6" type="radio" name="aport" value=1551207200596>
	</div>
</div>
				</div>
			</div>
		</div>
	</div>
	<div class="tab-2">
		<label for="tab2-2" class="disabled">Подтверждение</label><!-- -->
		<input id="tab2-2" name="tabs-two" type="radio" disabled="true"><!---->
		<div>
			
			<div class="cont-label">Правила отмены</div>
			<div class="cont-art">
				Если вы отмените это бронирование менее чем за 5 сут., с Вас будет удержана сумма бронирования в полном объеме.
			</div>

			<div class="cont-label">Данные гостя</div>
			<div class="cont-art">
				Данные не подлежат передаче и распространению, равно как и использованию в коммерческих целях.
			</div>		
			<form id="submit" action="">
			<!--<form id="submittt">-->
				<div class="form">
					<p class='field'>
						<input name="name" class='text-input' type="text" id="name" required pattern="^[А-ЯЁA-Zа-яёa-z]{3,20}$" maxlength="20" placeholder="Now">
						<label class="label" for="name">Имя</label>
					</p>
					<p class='field'>
						<input name="fameli" class='text-input' type="text" id="fameli" required pattern="^[А-ЯЁA-Zа-яёa-z]{1,20}$" maxlength="20" placeholder="Now">
						<label class="label" for="fameli">Фамилия</label>
					</p>
					<p class='field'>
						<input name="tel" class='text-input' type="text" id="tel" required pattern="^(8|\+7)\d{3}\d{7}$" placeholder="+7" maxlength="12">
						<label class="label" for="tel">Телефон</label>
					</p>				
					<!-- <p class='field'>
						<input name="mail" class='text-input' type="text" id="mail" required pattern="^\S+@\w+\.[\w.]{2,4}$" placeholder="Now">
						<label class="label" for="mail">E-mail</label>
					</p> -->
					<p class='field'>
						<input class='text-input' type="text" class="form-control" id="checktime" placeholder="Now" readonly>
						<label class="label" for="checktime">Желаемое время</label>
					</p>

					<p class="message">
						<textarea class="textarea" cols="50" id="message" name="message" rows="4" placeholder="Примечания или дополнительные запросы"></textarea>
						<label class="label" for="message">Примечания</label>
					</p>

				</div>
			<!--</form> -->

				<table class="tsummary">
					<tbody>
						<tr><th colspan="4">Сводка бронирования</th></tr>
						<tr>
							<td>Заезд:</td><td id="timein">now</td>
							<td>Выезд:</td><td id="timeout">now</td>
						</tr>
						<tr>
							<td colspan="2">Колличество дней</td>
							<td id="deys" colspan="2">now</td>
						</tr>
						<tr>
							<td colspan="2">Спальных мест</td>
							<td id="place" colspan="2">now</td>
						</tr>
						<tr>
							<td colspan="2">Цены за проживание c предоплатой</td>
							<td id="prace" colspan="2">now</td>
						</tr>
						<tr>
							<td colspan="2">Сумма предоплаты:</td>
							<td colspan="2">500 Р</td>
						</tr>
						<tr>
							<td id="after" colspan="2">Прибытиe</td>
							<td id="time" colspan="2">now</td>
						</tr>
						<tr>
							<td colspan="2">Ждем вас по адресу:</td>
							<td id="addres" colspan="2">now</td>
						</tr>
						<tr>
							<td colspan="2">По прибытию, звоните администратору по номеру:</td>
							<td colspan="2">+7 909 857 0114</td>
						</tr>
					</tbody>
				</table>
				<div class="form">
					<!--<form id="submit"> -->


					Я согласен с ---- политика конфиденциальности. Я даю разрешение объекту размещения Апарт-отель "Сити Парк" на обработку своих персональных данных

					Принимаю вышеуказанные условия аннуляции данного бронирования

					Мой адрес электронной почты ( ) указан верно

					<label for="check"><input type="checkbox" id="check" required> Отметьте, чтобы подтвердить согласие с вышеуказанными пунктами.</label>
					<p class="field">
						<input id="robokassa" class="button" type="submit" value="">
						<!-- <input id="yandexcase" class="button" type="submit" value="Send message">
						<input id="webmani" class="button" type="submit" value="Send message"> -->
					</p>
					<!--<input type="hidden" id="buking" name="payment" value="">-->

					<!--</form>-->
				</div>
			</form> 
		</div>
	</div>
</div>
<script>
	var picker = $('#dataBook').daterangepicker({
		"parentEl": "#findData",
		"locale": {
			"format": "LL",
			//"separator": ", ",
			"applyLabel": "Принять",
			"cancelLabel": "Отмена",
			"fromLabel": "От",
			"toLabel": "До",
			"invalidDateLabel": 'Выберите дату',
			"customRangeLabel": "Свой",
			"weekLabel": "W",
			"daysOfWeek": ['Вс', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб'],
			"monthNames": ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь', 'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'],
			"firstDay": 1
		},
		"startDate": moment().add(1, 'day'),
		"endDate": moment().add(2, 'day'),
		"minDate": moment().add(1, 'day'),
		"maxDate": moment().add(2, 'months'),
		"autoApply": true,
		"autoUpdateInput": false
	});
	picker.on('apply.daterangepicker', function (ev, picker) {

		var start = picker.startDate;
		var end = picker.endDate;
		//	var data = dialog.data('item');


		/*
		var selectedStartDate = start;//.format('LL');
        var selectedEndDate = end;//.format('LL');



        var checkinInput = $('#checkin').val(selectedStartDate);
        var checkoutInput = $('#checkout').val(selectedEndDate);

        var checkOutPicker = checkoutInput.data('daterangepicker');
        checkOutPicker.setStartDate(selectedStartDate);
        checkOutPicker.setEndDate(selectedEndDate);

        var checkInPicker = checkinInput.data('daterangepicker');
        checkInPicker.setStartDate(selectedStartDate);
        checkInPicker.setEndDate(selectedEndDate);
*/
		var start_t = '12:00';
	
		$(this).data('user', {'time_in': start.format('YYYY-MM-DD '+ start_t +':ss'),'time_out': end.format('YYYY-MM-DD '+ start_t +':ss')});
		
		$('#deys').text(end.diff(start, 'days'));
		$('#timein').text(start.format('LL'));
		$('#timeout').text(end.format('LL'));
		
		if(moment().isBefore(start, 'day'))
			$('#after').text('Прибытие ' + start.fromNow());

		$('#checktime').val(start_t);
		$('#time').text('в ' + moment(start_t, 'HH:mm').format('HH:mm a'));

		$('.table').removeClass('inactive');
		
		start = start.endOf('day');
		end = end.startOf('day');
		
		var events = null;
		var sel_shou = [];
		var sel_hide = [];
		$.each(events, function (id, curdates) {
			var dateEvents = $.map(curdates, function (event) {
				return {
					time_in: moment(event.time_in).endOf('day'),
					time_out: moment(event.time_out).startOf('day')
				};
			});

			var requ_interval = end.diff(start, 'days');
			var prev = dateEvents[0];
			var firstGap = null;
			var same = false;

			for (var i = 1; i < dateEvents.length; i++) {
				var current = dateEvents[i];
				var diff = current.time_in.diff(prev.time_out, 'days');// .subtract(1, 'd')

				if (diff >= requ_interval && current.time_in.isSameOrAfter(start) ) {
					firstGap = {
						time_in: prev.time_out,
						time_out: current.time_in
					};
					break;
				}
				prev = current;
			}

			if (firstGap != null){
				//console.log(start.isBetween(firstGap.time_in, firstGap.time_out, null, '(]'), end.isBetween(firstGap.time_in, firstGap.time_out, null, '[)'));
				if(start.isBetween(firstGap.time_in, firstGap.time_out) 
				   && end.isBetween(firstGap.time_in, firstGap.time_out)){
					same = true;
				}
				if(end.isSameOrBefore(dateEvents[0].time_in)){
					same = true;
				}
			}else if(end.isSameOrBefore(dateEvents[0].time_in))
				same = true;
			if (start.isSameOrAfter(dateEvents[dateEvents.length-1].time_out))
				same = true;

			if (!same) {
				sel_shou.push(id);
			} else {
				sel_hide.push(id);
			}
		});

		function selekt(data) {
			return '#' + data;
		} 
		$($.map(sel_shou, selekt).join(', ')).addClass('inactive');
		$($.map(sel_hide, selekt).join(', ')).removeClass('inactive');


	});
	// prevent hide after range selection
	picker.data('daterangepicker').hide = function () {};
	picker.data('daterangepicker').show();

	//$('.cell button').click(function(){$('.cell .aport').change();});
	$('.cell button').click(function () {
		
		$('#tab2-2').removeAttr('disabled').prop('checked', true);
		$('label[for=tab2-2]').attr('class', '');

		var efind = $(this).parents('.cell');

		$('#place').text(efind.children('.cell-body').find('.place > span').text());
		$('#addres').text(efind.find('.cell-header > .addres').text());
		$('#prace').text(efind.find('.cell-footer > .prace > span').text() + 'p.');
		
		var data = picker.data('user');
		//data.time_in = data.time_in.format('YYYY-MM-DD HH:mm:ss');
		//data.time_out = data.time_out.format('YYYY-MM-DD HH:mm:ss');
		data.uni_id = efind.attr('id');
		console.log($(this).siblings('.aport').val());
		console.log(efind.find('.cell-footer > .aport').val());

		$('html, body').animate({
			scrollTop: $(".tab-2").position().top
		}, 500);
		//return false;
	});

	
	$('#checktime').clockpicker({
		placement: 'bottom',
		align: 'left',
		autoclose: true,
		'default': 'now'
	}).change(function () {
//		console.log(this.value);
//		console.log(moment('2016-01-01T11:00').format('hh a'));

//		console.log(moment(this.value, 'HH:mm').format('hh a'));

		/*var time = $('#time').text();
    var newtime = moment(this.value, 'HH:mm').format('HH:mm a');
    $('#time').text(newtime +', '+ time.replace(/(.*?\,)/, ''))*/

		$('#time').text('в ' + moment(this.value, 'HH:mm').format('HH:mm a'));

		var time = picker.data('user');

		time.time_in = moment(time.time_in, 'YYYY-MM-DD HH:mm:ss').format('YYYY-MM-DD '+ this.value +':00');
		time.time_out = moment(time.time_out, 'YYYY-MM-DD HH:mm:ss').format('YYYY-MM-DD '+ this.value +':00');
	});
	
	$('.button').each(function(){
		$(this).click(function(e){
			//picker.data('user').payment = $(this).attr('id');
			//$('#buking').val(JSON.stringify(picker.data('user')));
			e.preventDefault();
			
			if(typeof picker.data('user') !== 'undefined'){
				var map = true;
				$.map($( "#submit" ).serializeArray(), function(v){
					if(v.value === '' && (v.name != 'message')){
						map = false;
						return false;
					}
					picker.data('user')[v.name] = v.value;
				});
				if(!map)
					return false;
			}else{
				return false;
			}
				
			$.post( "result.html",
				   { 'user': picker.data('user'), 'payment': $(this).attr('id') },
				   function( data ) {
				
				$( "footer" ).prepend( data );
				//$( "#submit" ).attr('action', data).submit();
			});
		});
	});
	//$( '#submit' ).submit(function( e ) {e.preventDefault();});
</script>
		<footer>
			
		</footer>
	</body>
</html>